# HTTPステータスコード

## HTTPステータスコードの大枠分類（API設計書向け）

| クラス                                     | 範囲    | 説明                                                                       | よく使うケース                                                                                                                                                                                                                                            | よくある誤解・注意点                                                                                                                                          |
| ------------------------------------------ | ------- | -------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **1xx: 情報 (Informational)**              | 100–199 | リクエストを受け取り処理を継続中。中間レスポンス。                         | ほぼ利用しない（プロトコル制御用途）                                                                                                                                                                                                                      | アプリ開発では基本的に意識不要。<br>無理に使うとクライアントが処理できない場合あり。                                                                          |
| **2xx: 成功 (Successful)**                 | 200–299 | リクエストが正常に処理された。                                             | - 200 OK: GET成功、PUT/PATCH更新成功<br>- 201 Created: POSTで新規作成成功<br>- 204 No Content: DELETE成功                                                                                                                                                 | - 新規作成で200を返してしまう（本来は201）<br>- DELETE成功時に200を返す（本来は204）                                                                          |
| **3xx: リダイレクト (Redirection)**        | 300–399 | リソースが移動・転送された。<br>クライアントは新しい場所へ再リクエスト。   | - 301 Moved Permanently: 永続移動<br>- 302 Found: 一時移動<br>- 304 Not Modified: キャッシュ有効                                                                                                                                                          | - 301と302の混同<br>- デバッグ時に304でレスポンスが返らず混乱                                                                                                 |
| **4xx: クライアントエラー (Client Error)** | 400–499 | クライアントのリクエストが不正。<br>構文エラー・認証エラー・権限不足など。 | - 400 Bad Request: 入力形式エラー<br>- 401 Unauthorized: 未認証<br>- 403 Forbidden: 認証済みだが権限なし<br>- 404 Not Found: リソースが存在しない<br>- 409 Conflict: リソース競合（重複、楽観ロック）<br>- 422 Unprocessable Entity: バリデーションエラー | - **401と403を混同**（未ログインなら401、権限不足なら403）<br>- バリデーションエラーを400で返してしまう（本来は422が適切）<br>- 入力値不正を404で返す（誤り） |
| **5xx: サーバエラー (Server Error)**       | 500–599 | サーバ内部でエラー発生。<br>クライアントのリクエストは正しいが処理に失敗。 | - 500 Internal Server Error: 想定外のエラー<br>- 503 Service Unavailable: サーバ過負荷・メンテ中                                                                                                                                                          | - クライアントエラーも雑に500で返す（API利用者が原因を判断できない）<br>- メンテナンス時に500を返す（本来は503）                                              |

## HTTPステータスコードと想定メソッド一覧

| コード  | 名称                     | 説明                                     | 主に使われるHTTPメソッド          | よくある誤解・間違えやすいケース                              |
| ------- | ------------------------ | ---------------------------------------- | --------------------------------- | ------------------------------------------------------------- |
| **200** | OK                       | リクエストが正常に処理された             | GET / POST / PUT / PATCH / DELETE | 成功しているが、バリデーションで一部無視しているのに200を返す |
| **201** | Created                  | 新しいリソースが作成された               | **POST**                          | 新規作成APIで200を返してしまう                                |
| **204** | No Content               | 正常終了したが返すデータがない           | DELETE / PUT / PATCH              | 削除APIで200を返してしまう                                    |
| **301** | Moved Permanently        | 永続的にリソースが移動                   | GET                               | 302と混同される                                               |
| **302** | Found (一時リダイレクト) | 一時的に別の場所にある                   | GET                               | 永続的な移動でも302を使ってしまう                             |
| **304** | Not Modified             | キャッシュが有効で変更なし               | GET                               | デバッグ時にキャッシュが原因で混乱                            |
| **400** | Bad Request              | リクエストが不正（構文エラーなど）       | 全メソッド                        | パスワードエラーを401と誤って返すケース                       |
| **401** | Unauthorized             | 認証が必要（未ログイン/トークン不正）    | 全メソッド                        | 「権限不足」で使ってしまう（本来403）                         |
| **403** | Forbidden                | 認証は成功したが権限が不足               | 全メソッド                        | 未ログイン時に返してしまう（本来401）                         |
| **404** | Not Found                | リソースが存在しない                     | GET / PUT / DELETE                | 入力エラーを404で返す（本来400/422）                          |
| **409** | Conflict                 | リソースの競合                           | POST / PUT / PATCH                | 重複登録や楽観ロックで500を返してしまう                       |
| **422** | Unprocessable Entity     | リクエストは正しいが意味的に処理できない | POST / PUT / PATCH                | バリデーションエラーを400で返してしまうが、422が正確          |
| **500** | Internal Server Error    | サーバ側のエラー                         | 全メソッド                        | 実際は400系なのに500で返すケース                              |
| **503** | Service Unavailable      | サービス一時停止・過負荷                 | 全メソッド                        | 単純なエラーで500と混同する                                   |

# よく間違えるセット

## 401 vs 403

- 401 = 未認証（ログインしていない）

- 403 = 認証済みだが権限不足

## 200 / 201 / 204

- POST成功 = 201
- DELETE成功 = 204
- 結果を返す処理 = 200

## 400 vs 422

- 400 = リクエスト形式が不正
- 422 = 形式は正しいが内容が不正（バリデーションNG）
