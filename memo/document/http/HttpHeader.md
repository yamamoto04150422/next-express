# HTTPヘッダ 抽象的な概念と業務イメージ

| 分類                 | ヘッダ例                       | 抽象的な概念                                 | 業務イメージ（比喩）                                                          | よくある利用シーン                                                                                                      |
| -------------------- | ------------------------------ | -------------------------------------------- | ----------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------- |
| **希望と実際**       | `Accept` / `Content-Type`      | 「クライアントの希望」と「サーバーの提供物」 | レストランで「パスタを頼む（Accept）」→「厨房がパスタを提供（Content-Type）」 | APIフェッチで JSON を期待 (`Accept: application/json`)、サーバーが実際に JSON を返す (`Content-Type: application/json`) |
| **条件付きアクセス** | `If-None-Match` / `ETag`       | 「最新版かどうかの確認」                     | 図書館で「最新版の本なら借りないでいい」                                      | ブラウザキャッシュ → サーバーが変化なしなら `304 Not Modified`                                                          |
| **交渉・優先度**     | `Accept-Language: ja,en;q=0.8` | 「優先順位つきリクエスト」                   | 多言語対応の窓口で「日本語が第一希望、英語でもOK」                            | サイト多言語化、翻訳サービス                                                                                            |
| **認証・権限**       | `Authorization`                | 「本人証明」                                 | 社員証を提示して入館する                                                      | ログイン済ユーザーだけアクセス可能な API                                                                                |
| **状態管理**         | `Cookie` / `Set-Cookie`        | 「継続的なやり取りのための印」               | 来店スタンプカード                                                            | ログインセッション、ユーザー追跡                                                                                        |
| **ルーティング**     | `Host`                         | 「どのサービスを呼ぶか」                     | マルチテナントビルの受付で「〇〇会社に行きたい」                              | 1つのサーバーで複数ドメインを運用する場合                                                                               |
| **キャッシュ制御**   | `Cache-Control`                | 「保存していいかのルール」                   | 倉庫に「冷蔵保存3日以内」と指示する                                           | 静的ファイルのキャッシュ効率化                                                                                          |

# レスポンスヘッダ例

| ヘッダー           | 抽象的な概念（役割）                   | 具体例                                | 利用シーン                             |
| ------------------ | -------------------------------------- | ------------------------------------- | -------------------------------------- |
| **Content-Type**   | 「中身の種類」宣言                     | `Content-Type: application/json`      | APIならJSON、HTMLならtext/htmlを返す   |
| **Content-Length** | 「中身のサイズ」宣言                   | `Content-Length: 1234`                | 転送サイズの確認や分割転送の判断       |
| **Cache-Control**  | 「キャッシュしていいか」の方針表明     | `Cache-Control: public, max-age=3600` | 静的ファイルのキャッシュ戦略           |
| **ETag**           | 「中身のバージョン番号」識別子         | `ETag: "abc123"`                      | 304判定に利用                          |
| **Last-Modified**  | 「最終更新日時」通知                   | `Last-Modified: Tue, 02 Sep 2025`     | 304判定やキャッシュ期限判断            |
| **Expires**        | 「有効期限」通知                       | `Expires: Wed, 03 Sep 2025`           | 古い仕様だがキャッシュ用途で利用される |
| **Set-Cookie**     | 「クライアントに記録してね」という指示 | `Set-Cookie: sessionid=xyz; HttpOnly` | ログインやトラッキング情報             |

# フロントエンド観点（Next.js / SPA側）

| ヘッダー          | 使用ケース                                                        | 使用頻度 | 備考                              |
| ----------------- | ----------------------------------------------------------------- | -------- | --------------------------------- |
| `Authorization`   | JWTやOAuthのアクセストークンを付与してAPI呼び出し                 | ★★★★☆    | Cookie認証なら不要                |
| `Cookie`          | 認証セッションやCSRFトークンを送信                                | ★★★★☆    | `credentials: include` が必要     |
| `Accept`          | APIからJSON/CSVなど欲しい形式を指定                               | ★★★★☆    | REST API利用時はほぼ必須          |
| `Content-Type`    | APIリクエストで送信するデータ形式を指定（例: `application/json`） | ★★★★☆    | POST/PUT/PATCH時に必要            |
| `Accept-Language` | 多言語対応アプリでユーザーの希望言語を伝える                      | ★★☆☆☆    | i18nが必要な場合のみ              |
| `Cache-Control`   | データ更新頻度が高い場合にキャッシュを無効化                      | ★★★☆☆    | SPAはキャッシュの影響を受けやすい |

# バックエンド観点（Spring Boot側）

| ヘッダー                           | 使用ケース                                         | 使用頻度 | 備考                                     |
| ---------------------------------- | -------------------------------------------------- | -------- | ---------------------------------------- |
| `Access-Control-Allow-Origin`      | CORS対応。フロントとバックが別ドメインの場合に必須 | ★★★★☆    | 本番では特定ドメインを指定すべき         |
| `Access-Control-Allow-Credentials` | Cookie認証時に必要                                 | ★★★★☆    | JWT + Bearer 方式なら不要                |
| `Access-Control-Allow-Headers`     | カスタムヘッダー（Authorizationなど）を許可する    | ★★★★☆    | CORS設定とセット                         |
| `Set-Cookie`                       | セッションIDやリフレッシュトークンを付与           | ★★★★☆    | `HttpOnly`, `Secure`, `SameSite` が重要  |
| `Content-Type`                     | レスポンス形式を明示（JSON, CSV, Excelなど）       | ★★★★☆    | クライアントが正しく処理できるように必須 |
| `Content-Disposition`              | CSV/Excel/PDFなどをダウンロードさせる              | ★★☆☆☆    | ファイル出力がある場合のみ               |
| `X-Content-Type-Options`           | MIMEスニッフィング防止                             | ★★★☆☆    | Spring SecurityでデフォルトON            |
| `X-Frame-Options`                  | iframeによるクリックジャッキング対策               | ★★★☆☆    | デフォルトは `DENY`                      |
| `Content-Security-Policy` (CSP)    | XSSや外部リソース制御                              | ★★☆☆☆    | セキュリティ要件が強い場合に導入         |
