# 実装詳細に踏み込まない React レビュー観点

## 目的

- 実装の好み・書き方ではなく「設計の良し悪し」を議論する
- レビューでの指摘を属人化させない
- テストと設計の責務を一致させる

---

## 製造観点（設計レビュー）

### 1. 責務が明確か

- コンポーネントが「何をする存在か」を一文で説明できる
- 状態・データ変換・副作用が無秩序に混ざっていない

**レビューの問い**

- このコンポーネントの責務は何か？
- ここでやるべきでない処理は含まれていないか？

---

### 2. 意図がコードから読み取れるか

- 「何をしているか」より「なぜそうしているか」が伝わる
- コメントは処理説明ではなく、意図・仕様の補足になっている

**レビューの問い**

- なぜこの構造・判断になっているのか説明できるか？
- コメントがなくても意図を推測できるか？

---

### 3. 状態管理がシンプルか

- 状態は最小限に抑えられている
- 状態の変更タイミング・トリガーが明確
- 状態の流れを口頭で説明できる

**レビューの問い**

- この state は本当に必要か？
- いつ・何がきっかけで変わるか明確か？

---

### 4. 拡張・変更を前提にしているか

- 要件追加時に「どこを触るか」が想像できる
- 条件分岐や例外が増えても破綻しない構造

**レビューの問い**

- 条件が1つ増えたら、どこを修正するか？
- 変更影響範囲を限定できているか？

---

### 5. テストしやすい構造か

- 実装がテストを困難にしていない
- 副作用と純粋な処理が分離されている

**レビューの問い**

- テストを書く前提で設計されているか？
- 副作用をモックせずに済む構造か？

---

# 単体テスト観点（何を保証しているか）

対象技術:

- Jest
- React Testing Library

対象範囲:

- 画面テスト
- コンポーネント単体テスト
- Yup バリデーションテスト
- Adapter テスト
- 業務ロジック（純粋関数）テスト

---

## 1. 画面テスト

### 保証しているもの

- ユーザー操作に対する画面全体の振る舞い

### 抽象的な保証

- 入力 → 操作 → 結果 の流れが成立する
- 異常系でもユーザーが迷わない
- 業務上ありえない状態にならない

**レビューの問い**

- このテストはどのユーザー行動を保証しているか？
- この画面が壊れると何が一番困るか？

---

## 2. コンポーネント単体テスト

### 保証しているもの

- コンポーネントの責務どおりの振る舞い

### 抽象的な保証

- props に応じた表示・イベントが正しい
- 再利用可能な部品として信頼できる

**レビューの問い**

- このコンポーネントの interface は何か？
- 親が変わっても意味を持つテストか？

---

## 3. Yup（バリデーション）テスト

### 保証しているもの

- 入力データが業務ルールを満たしていること

### 抽象的な保証

- 通してよい／だめなデータが明確
- UI に依存しない業務制約の保証

**レビューの問い**

- このルールは誰のルールか？
- UI が変わっても残るテストか？

---

## 4. Adapter テスト（境界テスト）

### 保証しているもの

- 画面データと業務・API仕様の正しい変換

### 抽象的な保証

- フォーム → API 変換が一意に決まる
- UI と API の変更影響を吸収できる

**レビューの問い**

- この変換はどこに属する責務か？
- 変更時に直す場所は明確か？

---

## 5. 業務ロジック（純粋関数）テスト

### 保証しているもの

- 業務判断・計算結果の正しさ

### 抽象的な保証

- UI や API に依存しない業務判断
- リファクタリング時の安全網

**レビューの問い**

- この関数が間違うと業務的に何が起きるか？
- UI を削除しても残るテストか？

---

## 単体テスト全体のバランス

### 危険な状態

- 画面テストだけで業務ルールを守っている
- 実装変更 = テスト修正になっている

### 良い状態

- 業務ルール：純粋関数 / Yup
- UI の責務：コンポーネント / 画面
- 失敗時に壊れたレイヤがすぐ分かる

---

## 単体テスト保証マップ

| レイヤ         | 保証内容       |
| -------------- | -------------- |
| 画面           | ユーザー体験   |
| コンポーネント | 部品の契約     |
| Adapter        | 境界・変換責務 |
| Yup            | 業務制約       |
| 純粋関数       | 業務判断       |

---

## レビューで使える一言

- 「このテストはどのレイヤの保証？」
- 「UI じゃなくても守るべきルール？」
- 「実装を変えても壊れない保証？」
- 「この失敗、業務的に説明できる？」
